<html lang="en>">
	
	<head>
		
		<title>Levelling</title>
		
		<style>
			
			*
			{
				padding: 0;
				margin: 0;
				border: none;
				outline: none;
			}
			
			body
			{
				background: #333;
				
				
				overflow: hidden;
			}
			
			.box
			{
				width: 40px;
				height: 40px;
				
				margin: 20px;
				
				float: left;
				
				background: #fff;
				
			}
			
			.box-inner
			{
				width: inherit;
				height: inherit;
				
				pointer-events: none;
				
				background: #ff0033;
			}
			
			#info
			{
				width: 100%;
				height: 100%;
				background: #000;
				position: absolute;
				
				top: 40%;
				left: 0;
				
				overflow: hidden;
			}
			
			#info p
			{
				width:  inherit;
				font-family: sans-serif;
				font-weight: bold;
				color: pink;
				padding: 20px;
			}
			
			#info_p1
			{
				/* width: 30%; */
				position: absolute;
				left: 0;
				
				text-align: left;
			}
			
			#info_p2
			{
				/* width: 30%; */
				position: absolute;
				right: 0;
				
				text-align: right;
			}
			
		</style>
		
		<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
		<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
		
		
		<script type="text/javascript">
			
			var trace = function(str){ console.log(str); };
			
			
			var p1_level = 0;
			var p2_level;
			
			var updateLevel = false;
			var updateLevelVal = 1;
			
			var enemyArray = new Array();
			
			var player_1 = {};
			var player_2 = {};
			
			var playerLevelSettings = {};
			
			function init(event)
			{
				trace(event);
				
				
				playerLevelSettings = 	{
											easy		: 0,
											medium		: 10,
											high		: 20,
											max_super	: 30
										};
				
				init_player1()
				
				populate();
			}
			
			function init_player1()
			{
				player_1.level = 0;
				player_1.attack = 0;
				player_1.difficulty = "";
				player_1.win = false;				
			
				playerLevelSort(player_1);
			}
			
			function purge_player1()
			{
				player_1.attack = 0;
				player_1.win = false;
			}
			
			function init_player2(lv, diff)
			{
				player_2.level = lv;
				player_2.attack = 0;
				player_2.difficulty = diff;
				player_2.win = false;				
			}
			
			function populate()
			{
				for(var i = 0; i < 40; i++)
				{
					var string_id = "box" + i;
					var string_lv = Math.floor(Math.random() * 30);
					
					var enemyHTML = '<div id="' + string_id + '" class="box" data-level="' + string_lv + '"><div class="box-inner"></div></div>';
				
					$("body").append(enemyHTML);
				}
			
				setup();
			}
			
			function setup()
			{
				$(".box").each(function(i)
				{
					var _id = $(this).attr("id");
					
					$(this).on("click", clickEvent);
					$(this).css("cursor", "pointer");
					
					var E = {};
					
					E._id = _id;
					E.level = parseInt($("#" + E._id).attr("data-level"));
					
					enemyArray.push(E);
				});
				
				splitDifficulty();
			}
			
			function splitDifficulty()
			{
				for(var i in enemyArray)
				{
					playerLevelSort(enemyArray[i]);
					
					if(enemyArray[i].difficulty === "APPRENTICE")
					{
						$("#" + enemyArray[i]._id + " .box-inner").css("opacity", 0.25);
					}
					
					else if(enemyArray[i].difficulty === "KNIGHT")
					{
						$("#" + enemyArray[i]._id + " .box-inner").css("opacity", 0.5);
					}
					
					else if(enemyArray[i].difficulty === "MASTER")
					{
						$("#" + enemyArray[i]._id + " .box-inner").css("opacity", 0.75);
					}
					
					else if(enemyArray[i].difficulty === "LORD")
					{
						$("#" + enemyArray[i]._id + " .box-inner").css("opacity", 1);
					}
					
					else
					{
						
					}
				}
			}
			
			function clickEvent(event)
			{
				for(var i in enemyArray)
				{
					if(event.target.id === enemyArray[i]._id)
					{
						sortEnemy(enemyArray[i]);
						
						break;
					}
				}
			}
			
			function sortEnemy(e_ob)
			{
				init_player2(e_ob.level, e_ob.difficulty);
				
				updateDisplay()
			}
			
			
			function updateDisplay()
			{
				$("#info_p1 .level").text(player_1.level);
				$("#info_p2 .level").text(player_2.level);
				
				$("#info_p1 .class").text(player_1.difficulty);
				$("#info_p2 .class").text(player_2.difficulty);
				
				$("#info_p1 .num").text(player_1.attack);
				$("#info_p2 .num").text(player_2.attack);
			
			}
			
			function playerLevelSort(player_ob)
			{
				if(player_ob.level >= playerLevelSettings.easy && player_ob.level < playerLevelSettings.medium)
				{
					player_ob.difficulty = "APPRENTICE";
				}
					
				else if(player_ob.level >= playerLevelSettings.medium && player_ob.level < playerLevelSettings.high)
				{	
					player_ob.difficulty = "KNIGHT";
				}
					
				else if(player_ob.level >= playerLevelSettings.high && player_ob.level < playerLevelSettings.max_super)
				{		
					player_ob.difficulty = "MASTER";
				}
					
				else
				{
					player_ob.difficulty = "LORD";
				}				
			}
			
			function player1_progress()
			{
				var updateLevel = false;
				var updateValue;
				
				if(player_1.level > player_2.level)
				{
					updateLevel = false;
				}
				
				if(player_1.level === player_2.level)
				{
					updateLevel = true;
					updateValue = player_1.level += 1;
				}
				
				if(player_1.level < player_2.level)
				{
					updateLevel = true;
					updateValue = player_2.level;
				}
				
				if(updateLevel)
				{
					player_1.level = updateValue;
					
					playerLevelSort(player_1);
				}
			}
			
			
			
			
/*
			function setup()
			{
				$(".box").each(function(i)
				{
					var id = $(this).attr("id");
					
					$(this).on("click", clickEvent);
					$(this).css("cursor", "pointer");
					
					switch($("#" + id).attr("data-difficulty"))
					{
						case "easy":
						{
							$("#" + id + " .box-inner").css("opacity", 0.25);
							
							break;
						}
						
						case "medium":
						{
							
							$("#" + id + " .box-inner").css("opacity", 0.5);
							
							break;
						}
						
						case "hard":
						{
							
							$("#" + id + " .box-inner").css("opacity", 0.75);
							
							break;
						}
						
						case "super":
						{
							$("#" + id + " .box-inner").css("opacity", 1);
							
							break;
						}
					}
					
					
				});
			}
			
			function clickEvent(event)
			{
				// trace("MY LEVEL == " + p1_level + " THEIR LEVEL == " + $("#" + event.target.id).attr("data-level"));
				
				
				
				// setLevel(p1_level, 100);
			
			
				p2_level = parseInt($("#" + event.target.id).attr("data-level"));
				
				trace("MY LEVEL == " + p1_level + " THEIR LEVEL == " + p2_level);
				
				
				updateLevels();
				
				test();
			}
			
			// test only
			function updateLevels()
			{
				record.p1_level = p1_level;
				record.p2_level = p2_level;
				
				$("#info_p1 .level").text(record.p1_level);
				$("#info_p2 .level").text(record.p2_level);
				
				$("#info_p1 .num").text(record.p1_num);
				$("#info_p2 .num").text(record.p2_num);
			
			}
			
			function test()
			{
				record.gameLevel = levelOffset();
				
				if(record.gameLevel >= 0 && record.gameLevel < 5)
				{
					record.difficulty = "EASY";
				}
				
				else if(record.gameLevel >= 5 && record.gameLevel < 10)
				{
					record.difficulty = "MEDIUM";
				}
				
				else if(record.gameLevel >= 10 && record.gameLevel < 90)
				{
					record.difficulty = "HARD";
				}
				
				else
				{
					record.difficulty = "SUPER";
				}
				
				mockFight();
				
				trace(record);
			}
			
			function setLevel(p1, p2)
			{
				p1_level = p1;
				p2_level = p2;
			}
			
			function levelOffset()
			{
				var newLevel;
				var setLevel;
				
				// ok
				if(p1_level === p2_level)
				{
					trace("EVEN");
					
					setLevel = 5; // medium normal
					
					updateLevel = true;
				}
				
				// ok
				else if(p1_level > p2_level)
				{
					trace("STRONGER");
					
					setLevel = 0;
					
					updateLevel = false;
				}
				
				else if(p1_level < p2_level)
				{
					trace("WEAKER");
					
					updateLevel = true;
					
					newLevel = Math.abs(p1_level - p2_level);
					
					record.checkLevel = newLevel;
					
					if(newLevel > 100)
					{
						setLevel = a[a.length - 1];
					}
					
					else
					{
						for(var i = 0; i < a.length; i++)
						{
							// ok
							
							if(newLevel === a[i])
							{
								setLevel = a[i];
							}
							
							else if(newLevel > a[i] && newLevel < a[i+1])
							{
								if(newLevel < (a[i] + Math.floor(a[i+1] * 0.5)))
								{
									setLevel = a[i];
								}
								
								else if(newLevel > (a[i] + Math.floor(a[i+1] * 0.5)))
								{
									setLevel = a[i+1];
								}
								
								else
								{
									setLevel = a[a.length - 1];
								}
							}
						}	
					}
				} 
				
				return setLevel;
			}
			
			function mockFight()
			{
				var beatNumber;
				var yourNumber;
				
				var experienceNumber0;
				
				// level up to MEDIUM
				
				if(p1_level > 5 && p1_level < 10)
				{
					experienceNumber = 10;
				}
				
				// level up to Hard
				
				else if(p1_level > 10)
				{
					experienceNumber = 20;
				}
				
				else
				{
					experienceNumber = 0;
				}
				
				yourNumber = Math.floor(Math.random() * (101 - experienceNumber) + experienceNumber);
				
				if(record.difficulty === "EASY")
				{
					beatNumber = 25;
				}
				
				if(record.difficulty === "MEDIUM")
				{
					beatNumber = 50;
				}
				
				if(record.difficulty === "HARD")
				{
					beatNumber = 75;
				}
				
				if(record.difficulty === "SUPER")
				{
					beatNumber = 101;
				}
				
				record.p1_num = yourNumber;
				record.p2_num = beatNumber;
				
				
				if(yourNumber > beatNumber)
				{
					$("#info_p1 .outcome").text("WIN");
					$("#info_p2 .outcome").text("DOOMED");
					
					
					// alert("WIN");
					
					result_win();
				}
				
				else if(yourNumber === beatNumber)
				{
					// alert("DRAW");
				
					$("#info_p1 .outcome").text("DRAW");
					$("#info_p2 .outcome").text("DRAW");
				}
				
				else
				{
					// alert("LOSE");
					
					$("#info_p1 .outcome").text("DOOMED");
					$("#info_p2 .outcome").text("WIN");
				}
				
				updateLevels();
			}
						
			function result_win()
			{
				if(updateLevel)
				{
					updateLevel = false;
					
					p1_level += updateLevelVal;
					
					updateLevels();
				}
				
				trace("END -- ");
				trace(record);
			}
*/
			
			
		</script>
		
	</head>
	
	<body onload="init(event);">
	
	
	
	<div id="info">
		
		<div id="info_p1">
			
			<p>PLAYER 1</p>
			<p>LEVEL	: <span class="level"></span></p>
			<p>CLASS	: <span class="class"></span></p>
			<p>BLOW		: <span class="num"></span></p>
			<p>RESULT	: <span class="outcome"></span></p>
		
		</div>
		
		<div id="info_p2">
			
			<p>PLAYER 2</p>
			<p>LEVEL	: <span class="level"></span></p>
			<p>CLASS	: <span class="class"></span></p>
			<p>BLOW		: <span class="num"></span></p>
			<p>RESULT	: <span class="outcome"></span></p>
		
		</div>
		
	</div>
	
	</body>
	
</html>